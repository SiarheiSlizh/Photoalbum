@model PLMvc.Models.PhotoCommentViewModel

@{
    ViewBag.Title = "Photo Details";
}

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="text-center">
                <img src="@string.Format("data:image/jpg;base64,{0}", Convert.ToBase64String(Model.Photo.Image))" class="img-responsive" alt="image" />
                <div id="updateLikes">
                   @Html.Partial("_Likes", Model.Photo)
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-10">
            <h4>@Model.Photo.Description</h4>
        </div>
        @if (User.Identity.Name == Model.User.UserName)
        {
            <div class="col-md-2">
                @using (Html.BeginForm("DeletePhoto", "Photo", new { photoId = Model.Photo.Id }, FormMethod.Post , null ))
                {
                    <div class="text-center">
                        <input type = "submit" class="btn btn-lg btn-danger" value="Delete" />
                    </div>
                }
            </div>
        }
    <div class="row">
        <div class="col-md-12">
            <div class="text-center">
                <h3 class="page-header">All comments</h3>
            </div>
        </div>
    </div>
    @using (Ajax.BeginForm("CreateComment", new { photoId = Model.Photo.Id, page = Model.CommentPaging.PageInfo.PageNumber}, 
        new AjaxOptions { UpdateTargetId = "updateComments", InsertionMode = InsertionMode.Replace, OnSuccess = "OnSuccess", OnFailure = "OnFailure" }))
    {
        <div class="row">
            <div class="col-md-11">
                @Html.TextArea("Comment", new { htmlAttributes = new { @class = "form-control", @id = "update" } })
            </div>
            <div class="col-md-1">
                @Html.ActionLink("Back", "ShowUser", "Home", new { userId = Model.User.Id }, null)
            </div>
        </div>
        <div class="row">
            <div class="col-md-2">
                <input type="submit" id="submit" value="Add Comment" class="btn btn-primary" />
            </div>
        </div>
    }
</div>
<div id = "updateComments" >
    @Html.Partial("_Comments", Model.CommentPaging)
</div>

@*<script type="text/javascript">
    function OnSuccess(data) {
        $(document).ready(function(){
            var content = "";
            $("#update").val(content);
        });​
    }
    function OnFailure(request, error) {
        alert("Fail");
    }
</script>*@